

```txt
ok
test fee::ffi::tests::test_calc_jones_gpu_via_ffi ... [Thread 0x7fffebfc7640 (LWP 17958) exited]
[New Thread 0x7fffebfc7640 (LWP 17959)]

Thread 104 "mwa_hyperbeam-8" received signal SIGBUS, Bus error.
[Switching to thread 104, lane 0 (AMDGPU Lane 1:1:1:1/0 (0,0,0)[0,0,0])]
0x00007fff68171608 in jones_p1sin_device (nmax=<error reading variable: Cannot access memory at address private_lane#0x446c>, theta=<error reading variable: Cannot access memory at address private_lane#0x4470>, p1sin_out=<error reading variable: Cannot access memory at address private_lane#0x4478>,
    p1_out=<error reading variable: Cannot access memory at address private_lane#0x4480>) at src/fee/gpu/fee.h:306
306                 p1sin_out[i] = Pm_sin_merged[modified];
(gdb) set args "fee::ffi::tests::test_calc_jones_gpu_via_ffi"
(gdb) r
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/dev/src/mwa_hyperbeam/target/debug/deps/mwa_hyperbeam-8ec1f3aea357db81 "fee::ffi::tests::test_calc_jones_gpu_via_ffi"
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

running 1 test
[New Thread 0x7fffebfc7640 (LWP 18447)]
[New Thread 0x7fffeb7ff640 (LWP 18448)]
[New Thread 0x7fffeaffe640 (LWP 18449)]
[Thread 0x7fffeaffe640 (LWP 18449) exited]
[New Thread 0x7fffe8bff640 (LWP 18450)]
[Thread 0x7fffe8bff640 (LWP 18450) exited]
[New Thread 0x7fffebb3f640 (LWP 18451)]

Thread 7 "mwa_hyperbeam-8" received signal SIGSEGV, Segmentation fault.
[Switching to thread 7, lane 0 (AMDGPU Lane 1:1:1:34/0 (16,0,0)[32,0,0])]
0x00007fffebb9ca8c in fee_kernel (coeffs=..., azs=0x0, zas=0x0, num_directions=0, norm_jones=0x0, latitude_rad=0x0, iau_order=0, fee_jones=0x0) at src/fee/gpu/fee.h:381
381                                const JONES *norm_jones, const FLOAT *latitude_rad, const int iau_order, JONES *fee_jones) {
```



works:

```bash
HYPERBEAM_HIP_ARCH=gfx1101 N_DIRS=1 DEBUG=1 RAYON_NUM_THREADS=1 cargo test --tests "fee::ffi::tests::test_calc_jones_gpu_via_ffi" --features=hip -- --test-threads=1
```

doesn't work

```bash
HYPERBEAM_HIP_ARCH=gfx1101 N_DIRS=999 DEBUG=1 RAYON_NUM_THREADS=1 cargo test --tests "fee::ffi::tests::test_calc_jones_gpu_via_ffi" --features=hip -- --test-threads=1
```

```bash
HYPERBEAM_HIP_ARCH=gfx1101 DEBUG=1 cargo test --no-run;
export test_bin=$(ls -1t target/debug/deps/mwa_hyperbeam-???????????????? | head -n 1)
N_DIRS=128 RAYON_NUM_THREADS=1  rocgdb --args $test_bin --test-threads=1 "fee::ffi::tests::test_calc_jones_gpu_via_ffi"


HYPERBEAM_HIP_ARCH=gfx1101 DEBUG=1 cargo test --no-run && export test_bin=$(ls -1t target/debug/deps/mwa_hyperbeam-???????????????? | head -n 1) N_DIRS=128 RAYON_NUM_THREADS=1 && rocgdb -x /home/dev/src/mwa_hyperbeam/rocgdbinit --args $test_bin --test-threads=1 "fee::ffi::tests::test_calc_jones_gpu_via_ffi"